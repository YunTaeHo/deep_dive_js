## 스코프란?

**스코프(Scope)** 란 변수나 함수 같은 **식별자(identifier)가 유효한 범위**를 의미합니다.
코드를 실행할 때 자바스크립트 엔진은 이 스코프를 기준으로 어떤 변수를 참조할지 결정하빈다. 이를 **식별자 결정(Identifier Resolution)** 이라고 합니다.

아래 예제를 통해 쉽게 이해할 수 있습니다.
```javascript
var x = 'global'; // 전역 스코프

function foo() {
  var x = 'local'; // 지역(함수) 스코프
  console.log(x); // 'local'을 출력
}

foo();
console.log(x); // 'global'을 출력
```
여기서 `x`라는 이름은 같지만, 스코프가 다르기 때문에 서로 다른 값을 참조하는 **별개의 변수**입니다.
이처럼 스코프는 코드가 어디서 실행되고 주변에 어떤 코드가 있는지에 따라 결정되는 **코드의 문맥(Context)** 과 깊은 관련이 있습니다.


### 변수의 스코프 결정 타이밍

변수의 스코프는 **선언된 위치**에 따라 결정됩니다.
- **함수 매개변수**: 함수의 몸체 `{}` 안에서만 유효한 지역 스코프를 가집니다.
스코프는 함수의 매개변수는 함수 몸체 내부에서만 참조가능한 것으로 확인 가능하고, 유효범위가 정해져있기 떄문이다.
```javascript
function add(x, y) { // x와 y는 add 함수의 지역 변수
  console.log(x, y); // 함수 내부에서는 접근 가능
  return x + y;
}

add(2, 5);
console.log(x, y); // ReferenceError: x is not defined (함수 밖에서는 접근 불가)
```
- **`var`키워드**: `var`로 선언된 변수는 **함수 레벨 스코프 (Function-level scope)** 를 따릅니다. 
이 함수 블록 `{}`내에서 선언된 변수만 지역 변수로 인정된다는 의미입니다. `if`, `for`문과 같은 코드 블록은 스코프로 인정하지 않습니다.
```javascript
var var1 = 1;

if (true) {
  var var2 = 2;
  if (true) {
    var var3 = 3;
  }
}

function foo() {
  var var4 = 4;

    function bar() {
      var var5 = 5;
    }
}

console.log(var1); // 1
console.log(var2); // 2
console.log(var3); // 3
console.log(var4); // 에러
console.log(var5); // 에러
```

### 스코프가 필요한 이유

스코프의 가장 중요한 역할은 **이름 충돌(Name Collision) 방지**입니다.
만약 스코프가 없다면 모든 변수가 하나의 공간을 공유하게 되어 같은 이름을 사용할 수 없게 됩니다.
- **파일 시스템**: 같은 폴더 안에 동일한 이름의 파일을 만들 수 없지만, 폴더를 다르게 만들면 같은 이름의 파일을 저장할 수 있는 것과 같습니다.
- **네임스페이스(Namespace)**: 스코프는 변수 이름을 격리시켜주는 일종의 **네임스페이스** 역할을 합니다. 
이를 통해 코드의 각 부분이 서로에게 영향을 주지 않고 독립적으로 변수 이름을 사용할 수 있어 프로그램의 안정성과 확장성을 높여줍니다.


### var 키워드로 선언한 변수의 중복 선언

`var`키워드는 같은 스코프 내에서 변수를 **중복 선언**하는 것을 허용합니다.
이는 문법 에러를 발생시키지 않고 기존 변수를 조용히 덮어쓰기 때문에, 의도치 않은 값 변경으로 이어져 심각한 버그의 원인이 될 수 있습니다.
```javascript
function getValue() {
  var x = 1;
  // ... 복잡한 로직 ...
  var x = 2; // 실수로 중복 선언. 에러가 발생하지 않고 값이 덮어씌워짐.
  console.log(x); // 2
}
```
반면 `let`과 `const`는 같은 스코프 내에서 변수를 중복 선언하면 즉시 문법 에러(`SynataxError`)를 발생시켜 개발자가 실수를 바로잡을 수 있도록 도와줍니다.
```javascript
function getValueSafely() {
  let x = 1;
  let x = 2; // SyntaxError: Identifier 'x' has already been declared
}
```

#### `let`, `const` 와의 차이

ES6부터 도입된 `let`과 `const`는 **블록 레벨 스코프(Block-level scope)**를 따릅니다.
즉, `if`, `for`문이나 일반적인 `{}` 코드 블록 내에서 선언되면 해당 블록 안에서만 유효합니다.
이는 `var`의 단점을 보완하여 더 예측 가능한 코드를 작성하게 해줍니다.
