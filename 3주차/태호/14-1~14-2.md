## 전역 변수의 문제점


전역 변수는 코드 어디에서든 접근할 수 있어, 편리해보이지만, **무분별하게 사용될 경우 애플리케이션의 복잡성을 높이고 잠재적인 오류의 원인이 되는 심각한 문제**를 초래할 수 있습니다.


## 변수의 생명 주기

모든 변수는 생성되고 소멸하는 **생명 주기(Life Cycle)** 를 가집니다. 
이는 변수가 메모리를 할당받는 시점부터 해제될 때까지의 기간을 의미하며, 변수가 선언된 위치, 즉 **스코프(Scope)** 에 따라 결정됩니다.

### 지역 변수의 생명 주기

**지역 변수**는 함수 내부에 선언된 변수로, 그 생명 주기는 **함수의 생명 주기**와 거의 일치합니다.
- **생성 시점**: 함수가 호출될 때
- **소멸 시점**: 함수가 종료될 때

함수가 실행되면 해당 함수만의 스코프가 생성되고, 그 안의 지역 변수들은 이 스코프에 등록됩니다.
함수 실행이 끝나면 이 스코프도 사라지면서 지역 변수들 역시 소멸합니다.
이처럼 생명 주기가 짧아 필요한 순간에만 메모리를 사용하고, 다른 코드에 영향을 미칠 가능성이 낮습니다.

#### 호이스팅 (Hoisting)

함수 내의 변수 선언(`var`)은 코드가 실행되기 전, 마치 함수의 최상단으로 끌어올려진 것처럼 먼저 처리됩니다.
이 때문에 선언문보다 앞에서 변수를 참조하면 오류 대신 `undefined`가 발생할 수 있습니다.
```javascript
function foo() {
  var x = 'local';
  console.log(x); // local
  return x;
}
foo();
console.log(x);
```
**클로저(Closure)** 와 같이 외부에서 함수 내부 스코프를 참조하는 특별한 경우에는 함수가 종료된 후에도 변수가 메모리에 남아 생명 주기가 길어지기도 합니다.


할당된 메모리 공간은 더 이상 그 누구도 참조하지 않을 때 가비지 컬렉터에 의해 해제되어 가용 메모리 풀에 반환됩니다.
즉, 누군가가 메모리 공간을 참조하고 있으면 해제되지 않고 확보된 상태로 남아 있게 됩니다.
스코프도 마찬가지입니다. 누군가 스코프를 참조하고 있으면 스코프는 소멸하지 않고 생존하게 됩니다.

일반적으로 함수가 종료되면 함수가 생성한 스코프도 소멸합니다.
하지만 누군가가 스코프를 참조하고 있다면 스코프는 해제되지 않고 생존하게 됩니다다.


### 전역 변수의 생명 주기

**전역 변수**는 함수 외부에서 선언된 변수로, 그 생명 주기는 **애플리케이션 생명 주기**와 같습니다.
- **생성 시점**: 스크립트 코드가 로드될 때.
- **소멸 시점**: 애플리케이션이 종료될 때(예: 웹페이지를 닫을 때)

`var` 키워드로 선언된 전역 변수는 **전역 객체(`window`, `globalThis` 등)** 의 프로퍼티가 됩니다.
이 전역 객체는 애플리케이션이 시작될 때 생성되어 종료될 때까지 유지되므로, 전역 변수 역시 그 생명 주기를 그대로 따라가게 됩니다.
이 긴 생명 주기는 메모리 누수나 이름 충돌 같은 문제를 일으키는 원인이 될 수 있습니다.


## 전역 변수의 문제점

### 암묵적 결합 (Implicit Coupling)

모든 코드가 전역 변수를 자유롭게 수정할 수 있어 **어디서 값이 바뀌었는지 추적하기 매우 어렵습니다.** 
이는 코드 간의 의존성을 높여 마치 보이지 않는 실로 얽힌 것처럼 만들고, 프로그램의 안정성과 유지보수성을 심각하게 저해합니다.


### 긴 생명 주기 (Long Lifecycle)

전역 변수는 애플리케이션이 종료될 때 까지 메모리를 차지하므로 **메모리 리소스 낭비**로 이어집니다.
또한, `var` 키워드는 변수 중복 선언을 허용하기 때문에, 생명 주기가 긴 전역 변수는 다른 코드에 의해 **의도치 않게 값이 덮어씌워질 위험**이 매우 큽니다.
```javascript
var x = 1;

var x = 100;
console.log(x);
```
지역 변수는 전역 변수보다 생명 주기가 극히 짧기 때문에 상태 변경에 의한 오류가 발생할 확률이 작습니다.

### 스코프 체인 상의 종점 (End of Scope Chain)

자바스크립트 엔진은 변수를 찾을 때 현재 스코프부터 시작해 상위 스코프로 올라갑니다.
전역 변수는 이 검색 체인의 가장 마지막에 있으므로 **검색 속도가 가장 느립니다.** 
성능에 미치는 영향은 미미하짐나 구조적인 단점입니다.

### 네임스페이스 오염

자바스크립트는 파일이 분리되어 있어도 **하나의 전역 스코프를 공유**합니다. 이로 인해 여러 파일이나 라이브러리에서 같은 이름의 전역 변수를 사용하면 **이름 충돌**이 발생하여 예상치 못한 결과를 초래할 수 있습니다